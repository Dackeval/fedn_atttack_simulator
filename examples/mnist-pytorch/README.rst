This needs to be rewritten to fit the simulator! 

